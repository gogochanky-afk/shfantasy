<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>My Entries Â· SH Fantasy</title>
  <style>
    :root{color-scheme:dark;}
    *{box-sizing:border-box;margin:0;padding:0;}
    body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;background:#0b0c0f;color:#eaeaea;}
    .wrap{max-width:640px;margin:0 auto;padding:24px 16px;}
    .nav{display:flex;justify-content:space-between;align-items:center;margin-bottom:28px;}
    .nav a{color:#888;font-size:13px;text-decoration:none;}
    .nav a:hover{color:#eaeaea;}
    h1{font-size:24px;font-weight:800;margin-bottom:4px;}
    .sub{color:#888;font-size:13px;margin-bottom:24px;}
    .card{background:#16181d;border:1px solid #2a2d35;border-radius:10px;padding:16px;margin-bottom:12px;}
    .card-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:10px;}
    .card-title{font-weight:700;font-size:15px;}
    .card-meta{font-size:12px;color:#888;margin-top:2px;}
    .badge{display:inline-block;padding:2px 7px;border-radius:4px;font-size:11px;font-weight:700;}
    .badge-saved{background:#1e3a1e;color:#4ade80;}
    .badge-nosave{background:#2a1e1e;color:#f87171;}
    .player-list{margin-top:10px;}
    .player-row{display:flex;justify-content:space-between;padding:5px 0;border-bottom:1px solid #1e2028;font-size:13px;}
    .player-row:last-child{border-bottom:none;}
    .player-row-name{font-weight:600;}
    .player-row-meta{color:#888;}
    .btn{padding:7px 14px;border-radius:6px;font-size:13px;font-weight:600;cursor:pointer;border:none;background:#3b82f6;color:#fff;}
    .btn:hover{background:#2563eb;}
    .btn-sm{padding:5px 10px;font-size:12px;}
    .btn-danger{background:#7f1d1d;color:#fca5a5;}
    .btn-danger:hover{background:#991b1b;}
    .empty{text-align:center;color:#555;padding:48px 0;font-size:14px;}
    .actions{display:flex;gap:8px;margin-top:10px;}
    .cap-info{font-size:12px;color:#888;margin-top:6px;}
  </style>
</head>
<body>
<div class="wrap">
  <nav class="nav">
    <a href="/">&larr; Home</a>
    <span style="font-weight:800;font-size:16px;">SH Fantasy</span>
  </nav>
  <h1>My Entries</h1>
  <p class="sub" id="username-display"></p>
  <div id="entries-container"><div class="empty">Loading...</div></div>
  <div style="margin-top:24px;text-align:center;">
    <button class="btn btn-danger btn-sm" onclick="clearAll()">Clear All Entries</button>
  </div>
</div>
<script>
(function(){
  var username=localStorage.getItem("shf_username")||"Guest";
  document.getElementById("username-display").textContent="Logged in as: "+username;
  function render(){
    var entries=JSON.parse(localStorage.getItem("shf_entries")||"[]");
    var lineups=JSON.parse(localStorage.getItem("shf_lineups")||"{}");
    var container=document.getElementById("entries-container");
    if(entries.length===0){container.innerHTML='<div class="empty">No entries yet.<br><br><a href="/" style="color:#3b82f6;">Join a pool</a></div>';return;}
    var html="";
    entries.slice().reverse().forEach(function(e){
      var lineup=lineups[e.entryId];
      var hasSave=!!(lineup&&lineup.players&&lineup.players.length>0);
      var savedAt=lineup?new Date(lineup.savedAt).toLocaleString():"";
      var totalCost=0;
      if(lineup&&lineup.playerDetails)lineup.playerDetails.forEach(function(p){totalCost+=(p.cost||0);});
      var ej=JSON.stringify(JSON.stringify(e.entryId));
      html+='<div class="card">';
      html+='<div class="card-header"><div><div class="card-title">'+esc(e.poolLabel||e.poolId)+'</div><div class="card-meta">Entry: '+esc(e.entryId)+' &middot; Joined: '+new Date(e.joinedAt).toLocaleString()+'</div></div>';
      html+='<span class="badge '+(hasSave?"badge-saved":"badge-nosave")+'">'+(hasSave?"Saved":"No Lineup")+'</span></div>';
      if(hasSave){
        html+='<div class="cap-info">Salary: $'+totalCost+' &middot; '+lineup.players.length+' players</div>';
        html+='<div class="player-list">';
        (lineup.playerDetails||[]).forEach(function(p){html+='<div class="player-row"><span class="player-row-name">'+esc(p.name)+'</span><span class="player-row-meta">'+esc(p.team)+' &middot; '+esc(p.position)+' &middot; $'+p.cost+'</span></div>';});
        html+='</div>';
        if(savedAt)html+='<div style="font-size:11px;color:#555;margin-top:6px;">Saved: '+savedAt+'</div>';
      }
      html+='<div class="actions"><a href="/draft.html?poolId='+encodeURIComponent(e.poolId)+'&entryId='+encodeURIComponent(e.entryId)+'" class="btn btn-sm">Edit Lineup</a>';
      html+='<button class="btn btn-sm btn-danger" onclick="removeEntry('+ej+')">Remove</button></div></div>';
    });
    container.innerHTML=html;
  }
  window.removeEntry=function(entryId){
    var entries=JSON.parse(localStorage.getItem("shf_entries")||"[]");
    entries=entries.filter(function(e){return e.entryId!==entryId;});
    localStorage.setItem("shf_entries",JSON.stringify(entries));
    var lineups=JSON.parse(localStorage.getItem("shf_lineups")||"{}");
    delete lineups[entryId];
    localStorage.setItem("shf_lineups",JSON.stringify(lineups));
    render();
  };
  window.clearAll=function(){
    if(!confirm("Clear all entries and lineups?"))return;
    localStorage.removeItem("shf_entries");
    localStorage.removeItem("shf_lineups");
    render();
  };
  function esc(s){return String(s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");}
  render();
})();
</script>
</body>
</html>